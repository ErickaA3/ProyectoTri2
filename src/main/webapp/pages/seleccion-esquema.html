<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi ProfesorIA - Seleccionar Esquema</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../css/seleccion-esquema.css">

</head>
<body>
    <!-- Navbar -->
    <nav class="main-navbar">
        <div class="navbar-left">
            <button class="menu-toggle" onclick="toggleMenu()">
                <i class="fas fa-bars"></i>
            </button>
            <div class="logo">
                <div class="logo-icon"><i class="fas fa-robot"></i></div>
                <span class="logo-text">Mi ProfesorIA</span>
            </div>
        </div>
        <div class="navbar-stats">
            <div class="stat-pill">
                <img src="../images/" alt="üî•" class="fire-gif">
                <span class="stat-value">5</span>
                <span class="stat-label">Racha</span>
            </div>
            <div class="stat-pill">
                <img src="glowing-star_1f31f.gif" alt="‚≠ê" class="star-gif">
                <span class="stat-value">2,450</span>
                <span class="stat-label">XP</span>
            </div>
            <div class="stat-pill">
                <img src="source.gif" alt="üíµ" class="money-gif">
                <span class="stat-value">850</span>
                <span class="stat-label">Monedas</span>
            </div>
        </div>
    </nav>

    <!-- Overlay -->
    <div class="sidebar-overlay" onclick="toggleMenu()"></div>

    <!-- Sidebar -->
    <aside class="sidebar-cards" id="sidebar">
        <div class="user-profile">
            <div class="user-avatar"><i class="fas fa-user"></i></div>
            <div class="user-name">Estudiante Pro</div>
            <div class="user-level">Nivel 12</div>
        </div>
        <div class="nav-cards">
            <a href="#" class="nav-card" onclick="handleNavClick(event)">
                <div class="nav-card-icon gradient-perfil"><i class="fas fa-user"></i></div>
                <div class="nav-card-content">
                    <div class="nav-card-title">Perfil</div>
                    <div class="nav-card-desc">Tu informaci√≥n</div>
                </div>
            </a>
            <a href="#" class="nav-card modo-estudio active" onclick="handleNavClick(event)">
                <div class="nav-card-icon gradient-estudio"><i class="fas fa-book-open"></i></div>
                <div class="nav-card-content">
                    <div class="nav-card-title">Modo Estudio</div>
                    <div class="nav-card-desc">Aprende a tu ritmo</div>
                </div>
            </a>
            <a href="#" class="nav-card" onclick="handleNavClick(event)">
                <div class="nav-card-icon gradient-profesor"><i class="fas fa-robot"></i></div>
                <div class="nav-card-content">
                    <div class="nav-card-title">Mi Profesor</div>
                    <div class="nav-card-desc">Asistente IA</div>
                </div>
            </a>
            <a href="#" class="nav-card" onclick="handleNavClick(event)">
                <div class="nav-card-icon gradient-duelo"><i class="fas fa-shield-alt"></i></div>
                <div class="nav-card-content">
                    <div class="nav-card-title">Duelos</div>
                    <div class="nav-card-desc">Reta a otros</div>
                </div>
            </a>
            <a href="#" class="nav-card" onclick="handleNavClick(event)">
                <div class="nav-card-icon gradient-tienda"><i class="fas fa-store"></i></div>
                <div class="nav-card-content">
                    <div class="nav-card-title">Tienda</div>
                    <div class="nav-card-desc">Personaliza tu perfil</div>
                </div>
            </a>
            <a href="#" class="nav-card" onclick="handleNavClick(event)">
                <div class="nav-card-icon gradient-favoritos"><i class="fas fa-heart"></i></div>
                <div class="nav-card-content">
                    <div class="nav-card-title">Favoritos</div>
                    <div class="nav-card-desc">Contenido guardado</div>
                </div>
            </a>
            <a href="#" class="nav-card" onclick="handleNavClick(event)">
                <div class="nav-card-icon gradient-historial"><i class="fas fa-clock-rotate-left"></i></div>
                <div class="nav-card-content">
                    <div class="nav-card-title">Historial</div>
                    <div class="nav-card-desc">Tu actividad reciente</div>
                </div>
            </a>
            <a href="#" class="nav-card" onclick="handleNavClick(event)">
                <div class="nav-card-icon gradient-ajustes"><i class="fas fa-cog"></i></div>
                <div class="nav-card-content">
                    <div class="nav-card-title">Ajustes</div>
                    <div class="nav-card-desc">Configuraci√≥n</div>
                </div>
            </a>
        </div>
    </aside>

    <!-- Contenido Principal -->
    <main class="content" id="mainContent">
        <canvas id="starsCanvas"></canvas>
        <!-- Nav / Breadcrumb -->
        <div class="esquema-nav">
            <a href="#" class="back-btn" onclick="goBack(event)">
                <i class="fas fa-arrow-left"></i>
                Volver
            </a>
            <div class="breadcrumb-trail">
                <span>Modo Estudio</span>
                <span class="sep"><i class="fas fa-chevron-right" style="font-size:0.6rem"></i></span>
                <span class="current">Esquemas</span>
            </div>
        </div>

        <!-- Header -->
        <div class="esquema-header">
            <h1 class="esquema-title">Selecciona un tipo de esquema</h1>
            <p class="esquema-subtitle">Elige el formato que mejor se adapte a tu contenido</p>
        </div>

        <!-- Grid top row (3 cards) -->
        <div class="esquema-grid">
            <!-- Jer√°rquico -->
            <div class="esquema-card" onclick="selectEsquema(this, 'jerarquico')">
                <div class="esquema-check"><i class="fas fa-check"></i></div>
                <div class="esquema-illustration illus-jerarquico">
                    <svg class="j-svg" viewBox="0 0 200 130" preserveAspectRatio="xMidYMid meet">
                        <defs>
                            <linearGradient id="jGrad1" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#8b5cf6"/>
                                <stop offset="100%" stop-color="#7c3aed"/>
                            </linearGradient>
                            <linearGradient id="jGrad2" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#a78bfa"/>
                                <stop offset="100%" stop-color="#8b5cf6"/>
                            </linearGradient>
                            <linearGradient id="jGrad3" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#c4b5fd"/>
                                <stop offset="100%" stop-color="#a78bfa"/>
                            </linearGradient>
                            <filter id="jGlow">
                                <feGaussianBlur stdDeviation="3" result="blur"/>
                                <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
                            </filter>
                            <filter id="jGlowSm">
                                <feGaussianBlur stdDeviation="2" result="blur"/>
                                <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
                            </filter>
                        </defs>

                        <!-- Lines: root ‚Üí mid row -->
                        <line x1="100" y1="25" x2="100" y2="38"/>
                        <line x1="42" y1="38" x2="158" y2="38"/>
                        <line x1="42" y1="38" x2="42" y2="48"/>
                        <line x1="100" y1="38" x2="100" y2="48"/>
                        <line x1="158" y1="38" x2="158" y2="48"/>

                        <!-- Lines: mid1 ‚Üí leaves -->
                        <line x1="42" y1="68" x2="42" y2="76"/>
                        <line x1="20" y1="76" x2="64" y2="76"/>
                        <line x1="20" y1="76" x2="20" y2="86"/>
                        <line x1="64" y1="76" x2="64" y2="86"/>

                        <!-- Lines: mid2 ‚Üí leaf -->
                        <line x1="100" y1="68" x2="100" y2="86"/>

                        <!-- Lines: mid3 ‚Üí leaves -->
                        <line x1="158" y1="68" x2="158" y2="76"/>
                        <line x1="136" y1="76" x2="180" y2="76"/>
                        <line x1="136" y1="76" x2="136" y2="86"/>
                        <line x1="180" y1="76" x2="180" y2="86"/>

                        <!-- Root node -->
                        <rect class="j-root-r" x="70" y="8" width="60" height="17"/>
                        <text x="100" y="17">Tema</text>

                        <!-- Mid nodes -->
                        <rect class="j-mid-r" x="17" y="48" width="50" height="20"/>
                        <rect class="j-mid-r" x="75" y="48" width="50" height="20"/>
                        <rect class="j-mid-r" x="133" y="48" width="50" height="20"/>

                        <!-- Leaf nodes -->
                        <rect class="j-leaf-r" x="4" y="86" width="32" height="16"/>
                        <rect class="j-leaf-r" x="48" y="86" width="32" height="16"/>
                        <rect class="j-leaf-r" x="84" y="86" width="32" height="16"/>
                        <rect class="j-leaf-r" x="120" y="86" width="32" height="16"/>
                        <rect class="j-leaf-r" x="164" y="86" width="32" height="16"/>
                    </svg>
                </div>
                <div class="esquema-card-title">Jer√°rquico</div>
                <div class="esquema-card-desc">Organiza ideas de lo general a lo espec√≠fico</div>
            </div>

            <!-- Conceptual -->
            <div class="esquema-card" onclick="selectEsquema(this, 'conceptual')">
                <div class="esquema-check"><i class="fas fa-check"></i></div>
                <div class="esquema-illustration illus-conceptual">
                    <!-- SVG lines connecting center to bubbles -->
                    <svg class="c-lines-svg" viewBox="0 0 100 100" preserveAspectRatio="none">
                        <!-- center(50,50) ‚Üí b1 top-center(50,13) -->
                        <line x1="50" y1="50" x2="50" y2="13"/>
                        <!-- center ‚Üí b2 top-right(86,28) -->
                        <line x1="50" y1="50" x2="86" y2="28"/>
                        <!-- center ‚Üí b3 bottom-right(83,72) -->
                        <line x1="50" y1="50" x2="83" y2="72"/>
                        <!-- center ‚Üí b4 bottom-center(50,87) -->
                        <line x1="50" y1="50" x2="50" y2="87"/>
                        <!-- center ‚Üí b5 bottom-left(16,72) -->
                        <line x1="50" y1="50" x2="16" y2="72"/>
                        <!-- center ‚Üí b6 top-left(16,28) -->
                        <line x1="50" y1="50" x2="16" y2="28"/>
                    </svg>
                    <div class="c-bubble c-b1"></div>
                    <div class="c-bubble c-b2"></div>
                    <div class="c-bubble c-b3"></div>
                    <div class="c-bubble c-b4"></div>
                    <div class="c-bubble c-b5"></div>
                    <div class="c-bubble c-b6"></div>
                    <div class="c-center"><i class="fas fa-lightbulb" style="color:#fff"></i></div>
                </div>
                <div class="esquema-card-title">Conceptual</div>
                <div class="esquema-card-desc">Conecta conceptos e ideas relacionadas</div>
            </div>

            <!-- L√≠nea del tiempo -->
            <div class="esquema-card" onclick="selectEsquema(this, 'timeline')">
                <div class="esquema-check"><i class="fas fa-check"></i></div>
                <div class="esquema-illustration illus-timeline">
                    <div class="t-line-main"></div>
                    <div class="t-dot t-dot-1"></div>
                    <div class="t-dot t-dot-2"></div>
                    <div class="t-dot t-dot-3"></div>
                    <div class="t-dot t-dot-4"></div>
                    <div class="t-dot t-dot-5"></div>
                    <div class="t-card t-card-1 t-card-above"><div class="t-stem t-stem-up"></div></div>
                    <div class="t-card t-card-2 t-card-below"><div class="t-stem t-stem-down"></div></div>
                    <div class="t-card t-card-3 t-card-above"><div class="t-stem t-stem-up"></div></div>
                    <div class="t-card t-card-4 t-card-below"><div class="t-stem t-stem-down"></div></div>
                    <div class="t-card t-card-5 t-card-above"><div class="t-stem t-stem-up"></div></div>
                </div>
                <div class="esquema-card-title">L√≠nea del tiempo</div>
                <div class="esquema-card-desc">Eventos ordenados cronol√≥gicamente</div>
            </div>
        </div>

        <!-- Grid bottom row (2 cards centered) -->
        <div class="esquema-grid-bottom">
            <!-- Causa y efecto -->
            <div class="esquema-card" onclick="selectEsquema(this, 'causa-efecto')">
                <div class="esquema-check"><i class="fas fa-check"></i></div>
                <div class="esquema-illustration illus-causa">
                    <!-- Tail -->
                    <div class="fish-tail"></div>
                    <!-- Spine -->
                    <div class="fish-spine"></div>
                    <!-- Head -->
                    <div class="fish-head"></div>
                    <div class="fish-head-label">Efecto</div>

                    <!-- Top branches -->
                    <div class="fish-branch top fb-1"></div>
                    <div class="fish-branch top fb-2"></div>
                    <div class="fish-branch top fb-3"></div>

                    <!-- Bottom branches -->
                    <div class="fish-branch bottom fb-1"></div>
                    <div class="fish-branch bottom fb-2"></div>
                    <div class="fish-branch bottom fb-3"></div>

                    <!-- Cause lines top -->
                    <div class="cause-line cl-1a"></div>
                    <div class="cause-line cl-1b"></div>
                    <div class="cause-line cl-2a"></div>
                    <div class="cause-line cl-2b"></div>
                    <div class="cause-line cl-3a"></div>
                    <div class="cause-line cl-3b"></div>

                    <!-- Cause lines bottom -->
                    <div class="cause-line cl-4a"></div>
                    <div class="cause-line cl-4b"></div>
                    <div class="cause-line cl-5a"></div>
                    <div class="cause-line cl-5b"></div>
                    <div class="cause-line cl-6a"></div>
                    <div class="cause-line cl-6b"></div>

                    <!-- Causa text labels top -->
                    <span class="causa-label top-1a">Causa</span>
                    <span class="causa-label top-1b">Causa</span>
                    <span class="causa-label top-2a">Causa</span>
                    <span class="causa-label top-2b">Causa</span>
                    <span class="causa-label top-3a">Causa</span>
                    <span class="causa-label top-3b">Causa</span>

                    <!-- Causa text labels bottom -->
                    <span class="causa-label bot-4a">Causa</span>
                    <span class="causa-label bot-4b">Causa</span>
                    <span class="causa-label bot-5a">Causa</span>
                    <span class="causa-label bot-5b">Causa</span>
                    <span class="causa-label bot-6a">Causa</span>
                    <span class="causa-label bot-6b">Causa</span>
                </div>
                <div class="esquema-card-title">Causa y efecto</div>
                <div class="esquema-card-desc">Identifica causas y sus consecuencias</div>
            </div>

            <!-- C√≠clico -->
            <div class="esquema-card" onclick="selectEsquema(this, 'ciclico')">
                <div class="esquema-check"><i class="fas fa-check"></i></div>
                <div class="esquema-illustration illus-ciclico">
                    <div class="cy-ring">
                        <div class="cy-arrow cy-arrow-top"></div>
                        <div class="cy-arrow cy-arrow-right"></div>
                        <div class="cy-arrow cy-arrow-bottom"></div>
                        <div class="cy-arrow cy-arrow-left"></div>
                        <div class="cy-center-icon"><i class="fas fa-sync-alt"></i></div>
                        <div class="cy-label cy-label-1">Fase 1</div>
                        <div class="cy-label cy-label-2">Fase 2</div>
                        <div class="cy-label cy-label-3">Fase 3</div>
                        <div class="cy-label cy-label-4">Fase 4</div>
                    </div>
                </div>
                <div class="esquema-card-title">C√≠clico</div>
                <div class="esquema-card-desc">Procesos que se repiten en un ciclo</div>
            </div>
        </div>

        <!-- Confirm Button -->
        <div class="confirm-btn-wrapper">
            <button class="confirm-btn" id="confirmBtn" onclick="confirmSelection()" disabled>
                <span>Continuar</span>
            </button>
        </div>
    </main>

    <!-- Toast -->
    <div class="toast" id="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toastMessage">Tipo seleccionado</span>
    </div>

    <script>
        let selectedType = null;

        function selectEsquema(card, type) {
            // Deselect all
            document.querySelectorAll('.esquema-card').forEach(c => c.classList.remove('selected'));
            
            // Select clicked
            card.classList.add('selected');
            selectedType = type;
            
            // Enable button
            document.getElementById('confirmBtn').disabled = false;
            
            // Map types to names
            const names = {
                'jerarquico': 'Jer√°rquico',
                'conceptual': 'Conceptual',
                'timeline': 'L√≠nea del tiempo',
                'causa-efecto': 'Causa y efecto',
                'ciclico': 'C√≠clico'
            };
            
            showToast(`Esquema ${names[type]} seleccionado`);
        }

        function confirmSelection() {
            if (!selectedType) return;
            
            const btn = document.getElementById('confirmBtn');
            btn.innerHTML = '<div style="width:22px;height:22px;border:3px solid rgba(45,212,191,0.3);border-top-color:#2dd4bf;border-radius:50%;animation:spin 1s linear infinite"></div> <span>Cargando...</span>';
            btn.disabled = true;
            
            console.log('Tipo de esquema seleccionado:', selectedType);
            
            setTimeout(() => {
                btn.innerHTML = '<span>Continuar</span>';
                btn.disabled = false;
                showToast('¬°Redirigiendo al editor de esquemas...');
            }, 2000);
        }

        function goBack(e) {
            e.preventDefault();
            showToast('Volviendo a Modo Estudio...');
            // In production: window.location.href = 'modo-estudio.html';
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            document.getElementById('toastMessage').textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        function toggleMenu() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.querySelector('.sidebar-overlay');
            sidebar.classList.toggle('active');
            overlay.classList.toggle('active');
            document.body.style.overflow = sidebar.classList.contains('active') ? 'hidden' : '';
        }

        function handleNavClick(event) {
            if (window.innerWidth <= 768) toggleMenu();
            document.querySelectorAll('.nav-card').forEach(card => card.classList.remove('active'));
            event.currentTarget.classList.add('active');
        }

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && window.innerWidth <= 768) {
                const sidebar = document.getElementById('sidebar');
                if (sidebar.classList.contains('active')) toggleMenu();
            }
        });

        // ===== STARS CANVAS ANIMATION =====
        (function initStars() {
            const canvas = document.getElementById('starsCanvas');
            const ctx = canvas.getContext('2d');
            const content = document.getElementById('mainContent');

            function resizeCanvas() {
                canvas.width = content.offsetWidth;
                canvas.height = content.scrollHeight;
            }
            resizeCanvas();

            const stars = [];
            const starCount = 150;

            for (let i = 0; i < starCount; i++) {
                stars.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    size: Math.random() * 2 + 0.3,
                    speedX: (Math.random() - 0.5) * 0.1,
                    speedY: (Math.random() - 0.5) * 0.1,
                    opacity: Math.random() * 0.4 + 0.1,
                    opacityChange: (Math.random() - 0.5) * 0.012,
                    color: ['#ffffff', '#ffffff', '#ffe9c4', '#d4f1ff', '#c4b5fd', '#aaddff'][Math.floor(Math.random() * 6)]
                });
            }

            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                stars.forEach(star => {
                    star.x += star.speedX;
                    star.y += star.speedY;

                    if (star.x < 0) star.x = canvas.width;
                    if (star.x > canvas.width) star.x = 0;
                    if (star.y < 0) star.y = canvas.height;
                    if (star.y > canvas.height) star.y = 0;

                    star.opacity += star.opacityChange;
                    if (star.opacity <= 0.05 || star.opacity >= 0.8) {
                        star.opacityChange *= -1;
                    }

                    ctx.beginPath();
                    ctx.arc(star.x, star.y, star.size, 0, Math.PI * 2);
                    ctx.fillStyle = star.color;
                    ctx.globalAlpha = star.opacity;
                    ctx.fill();

                    // Glow for bigger stars
                    if (star.size > 1.5) {
                        ctx.beginPath();
                        ctx.arc(star.x, star.y, star.size * 2.5, 0, Math.PI * 2);
                        ctx.fillStyle = star.color;
                        ctx.globalAlpha = star.opacity * 0.2;
                        ctx.fill();
                    }
                });

                ctx.globalAlpha = 1;
                requestAnimationFrame(animate);
            }

            animate();
            window.addEventListener('resize', resizeCanvas);
        })();
    </script>
</body>
</html>
